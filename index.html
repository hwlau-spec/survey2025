<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>25-28é«˜ä¸­Bçµ„ï¼æœªä¾†å°èˆªè‡ªè©•</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;500;700&display=swap');
        
        :root {
            --primary: #2563eb;
            --secondary: #64748b;
            --accent: #f59e0b;
            --bg-soft: #f8fafc;
        }

        html { scroll-behavior: smooth; }
        body { 
            font-family: 'Noto Sans TC', sans-serif; 
            background: var(--bg-soft); 
            color: #1e293b;
            line-height: 1.6;
        }

        .gradient-bg {
            background: radial-gradient(circle at top right, #e0f2fe 0%, #f8fafc 40%),
                        radial-gradient(circle at bottom left, #eef2ff 0%, #f8fafc 40%);
        }

        .hero-section {
            background: linear-gradient(135deg, #0f172a 0%, #1e3a8a 100%);
            clip-path: ellipse(150% 100% at 50% 0%);
        }

        .glass-card {
            background: rgba(255, 255, 255, 0.8);
            backdrop-filter: blur(12px);
            border: 1px solid rgba(255, 255, 255, 0.5);
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.05), 0 8px 10px -6px rgba(0, 0, 0, 0.05);
            transition: all 0.3s ease;
        }

        .input-field {
            width: 100%;
            padding: 14px;
            border: 2px solid #e2e8f0;
            border-radius: 16px;
            transition: all 0.3s;
            background: white;
            resize: vertical;
        }

        .input-field:focus {
            border-color: var(--primary);
            outline: none;
            box-shadow: 0 0 0 4px rgba(37, 99, 235, 0.1);
        }

        .section-title {
            position: relative;
            display: inline-block;
            margin-bottom: 2.5rem;
        }

        .section-title::after {
            content: '';
            position: absolute;
            bottom: -8px;
            left: 0;
            width: 40%;
            height: 4px;
            background: var(--primary);
            border-radius: 2px;
        }

        .quadrant-container {
            position: relative;
            width: 100%;
            max-width: 280px;
            aspect-ratio: 1;
            background: white;
            border: 3px solid #1e293b;
            border-radius: 12px;
            margin: 0 auto;
            cursor: crosshair;
            overflow: hidden;
        }
        .axis-h { position: absolute; top: 50%; left: 0; width: 100%; height: 2px; background: #cbd5e1; }
        .axis-v { position: absolute; left: 50%; top: 0; width: 2px; height: 100%; background: #cbd5e1; }
        .quad-label { 
            position: absolute; font-size: 11px; font-weight: bold; padding: 4px; z-index: 10;
            pointer-events: none; width: 45%; text-align: center; color: #475569;
        }
        #target-dot {
            position: absolute;
            width: 20px;
            height: 20px;
            background: #ef4444;
            border: 3px solid white;
            border-radius: 50%;
            transform: translate(-50%, -50%);
            display: none;
            z-index: 20;
            box-shadow: 0 0 10px rgba(239, 68, 68, 0.5);
        }

        .tag-btn {
            padding: 8px 16px;
            border-radius: 999px;
            border: 2px solid #e2e8f0;
            background: white;
            font-size: 0.875rem;
            transition: all 0.2s;
        }

        .tag-btn.active {
            background: var(--primary);
            color: white;
            border-color: var(--primary);
        }

        #loading-overlay {
            display: none;
            position: fixed;
            inset: 0;
            background: rgba(15, 23, 42, 0.9);
            z-index: 9999;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            color: white;
        }

        #main-content { display: none; }
    </style>
</head>
<body class="gradient-bg">

    <div id="loading-overlay">
        <div class="animate-spin rounded-full h-16 w-16 border-b-4 border-blue-400"></div>
        <p class="mt-6 text-xl">æ­£åœ¨åŒæ­¥å°èˆªæ•¸æ“š...</p>
    </div>

    <!-- å°èˆªæ¬„ z-index èª¿æ•´ä»¥é˜²é®æ“‹ -->
    <nav class="sticky top-0 z-40 bg-white/80 backdrop-blur-lg border-b border-slate-200">
        <div class="max-w-6xl mx-auto px-6 py-4 flex justify-between items-center">
            <div class="flex items-center gap-3">
                <span class="text-3xl">ğŸš€</span>
                <span class="text-xl font-bold bg-clip-text text-transparent bg-gradient-to-r from-blue-600 to-indigo-600">æœªä¾†å°èˆªè‡ªè©•</span>
            </div>
            <div id="user-display" class="hidden md:block text-sm font-semibold px-4 py-2 bg-blue-50 text-blue-700 rounded-full"></div>
        </div>
    </nav>

    <header class="hero-section text-white pt-16 pb-24 px-6 text-center">
        <div class="max-w-4xl mx-auto">
            <div class="inline-flex items-center gap-2 bg-white/10 px-4 py-1.5 rounded-full text-sm backdrop-blur-md mb-6">
                âœ¨ 25/28 é«˜ä¸­Bçµ„ Â· å­¸ç”Ÿå­¸ç¿’ç”Ÿæ´»è‡ªè©•
            </div>
            <h1 class="text-3xl md:text-5xl font-extrabold mb-6">çœ‹è¦‹é‚£å€‹åœ¨å£“åŠ›ä¸‹å‰è¡Œçš„è‡ªå·±</h1>
            <p class="text-slate-300 max-w-2xl mx-auto mb-10 leading-relaxed">
                æ­å–œå¤§å®¶å®Œæˆäº†ç¬¬ä¸€å€‹é«˜ä¸­è€ƒè©¦ã€‚å…©ä½ç­ä¸»ä»»åŠ‰sirå’Œè­šsirå¸Œæœ›ä½ åœ¨å®¶é•·æ—¥å‰ï¼Œå›é¡§é€™æ®µæ™‚é–“çš„æ­·ç¨‹ã€‚
            </p>
            
            <div class="max-w-md mx-auto">
                <select id="student-selector" class="w-full p-4 rounded-2xl text-slate-900 font-bold border-none shadow-xl focus:ring-4 focus:ring-blue-400" onchange="unlockContent()">
                    <option value="">ğŸ‘¤ é»æ“Šé¸æ“‡ä½ çš„å§“å (å­¸è™Ÿ)</option>
                    <option value="è”¡å¼ˆå¸Œ (01)">è”¡å¼ˆå¸Œ (01)</option><option value="é™³ç…œ (02)">é™³ç…œ (02)</option><option value="é™³æµ©éŠ“ (03)">é™³æµ©éŠ“ (03)</option>
                    <option value="é™³å‡±å¡‹ (04)">é™³å‡±å¡‹ (04)</option><option value="é™³ç†™éºŸ (05)">é™³ç†™éºŸ (05)</option><option value="é™³ç‚¯éœ– (06)">é™³ç‚¯éœ– (06)</option>
                    <option value="é™³æ³³éœ (07)">é™³æ³³éœ (07)</option><option value="é„­åŒ¡æ™‰ (08)">é„­åŒ¡æ™‰ (08)</option><option value="å¼µæ¥·ç†¹ (09)">å¼µæ¥·ç†¹ (09)</option>
                    <option value="ä¸æ³“éœ– (10)">ä¸æ³“éœ– (10)</option><option value="æ–¹å† é©Š (11)">æ–¹å† é©Š (11)</option><option value="éƒ­æµ©æ¥  (12)">éƒ­æµ©æ¥  (12)</option>
                    <option value="èƒ¡è‡³ç‚º (13)">èƒ¡è‡³ç‚º (13)</option><option value="é»ƒå¯æ™´ (14)">é»ƒå¯æ™´ (14)</option><option value="é»ƒé›¨æ¶µ (15)">é»ƒé›¨æ¶µ (15)</option>
                    <option value="è”£æ²‚æ’ (16)">è”£æ²‚æ’ (16)</option><option value="æ±Ÿæ–‡çª (17)">æ±Ÿæ–‡çª (17)</option><option value="é—œå¿ƒç‘œ (18)">é—œå¿ƒç‘œ (18)</option>
                    <option value="æå…¬æº¥ (19)">æå…¬æº¥ (19)</option><option value="æ—æ¬£ç€… (20)">æ—æ¬£ç€… (20)</option><option value="ç¾…éœæ€¡ (21)">ç¾…éœæ€¡ (21)</option>
                    <option value="éº¥ç‘‹å»¸ (22)">éº¥ç‘‹å»¸ (22)</option><option value="è¦ƒå† éœ– (23)">è¦ƒå† éœ– (23)</option><option value="ä½˜æ›‰æ¥  (24)">ä½˜æ›‰æ¥  (24)</option>
                    <option value="æ›¾éŠ˜è¬™ (25)">æ›¾éŠ˜è¬™ (25)</option><option value="æº«æ…¶ç…œ (26)">æº«æ…¶ç…œ (26)</option><option value="ç‹å‹æ¾ (27)">ç‹å‹æ¾ (27)</option>
                    <option value="ç‹å‹æŸ (28)">ç‹å‹æŸ (28)</option><option value="å³ä¿Šå® (29)">å³ä¿Šå® (29)</option><option value="æ›¾ç¿å®¸ (30)">æ›¾ç¿å®¸ (30)</option>
                    <option value="å¼µæ’å˜‰ (31)">å¼µæ’å˜‰ (31)</option><option value="å¼µæ¢“æ¡ (32)">å¼µæ¢“æ¡ (32)</option><option value="é„­å˜‰åª› (33)">é„­å˜‰åª› (33)</option>
                    <option value="é„­ç³ (34)">é„­ç³ (34)</option><option value="å‘¨æ„ç¿” (35)">å‘¨æ„ç¿” (35)</option><option value="æœ±é åœ³ (36)">æœ±é åœ³ (36)</option>
                </select>
            </div>
        </div>
    </header>

    <main id="main-content" class="max-w-6xl mx-auto px-6 -mt-16 pb-24 relative z-10">
        
        <!-- ç¬¬ä¸€éƒ¨åˆ†ï¼šå„ªåŒ–äº†å¡ç‰‡å…§éƒ¨é–“è· -->
        <section class="mb-16">
            <h2 class="section-title text-2xl font-bold">ç¬¬ä¸€éƒ¨åˆ†ï¼šå­¸æ¥­ç­–ç•¥èˆ‡èªçŸ¥éŸŒæ€§</h2>
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                <div class="glass-card p-6 md:p-8 rounded-3xl">
                    <label class="block font-bold text-slate-800 mb-3">ğŸ’ª ã€ŒéŸŒæ€§ã€æ™‚åˆ» (å¿…å¡«)</label>
                    <textarea id="resilience-text" class="input-field h-32" placeholder="é¢å°æœ€è‰±é›£èª²é¡Œï¼Œä½ æ˜¯å¦‚ä½•é¼“å‹µè‡ªå·±å …æŒä¸‹å»çš„ï¼Ÿ"></textarea>
                </div>
                <div class="glass-card p-6 md:p-8 rounded-3xl">
                    <label class="block font-bold text-slate-800 mb-3">âš™ï¸ ç­–ç•¥é€²åŒ–è«– (å¿…å¡«)</label>
                    <textarea id="strategy-text" class="input-field h-32" placeholder="ç›¸æ¯”ä»¥å¾€ï¼Œä½ åœ¨å­¸ç¿’å·¥å…·æˆ–æ–¹å¼ä¸Šæœ‰å“ªäº›å…·é«”é€²æ­¥ï¼Ÿ"></textarea>
                </div>
                <div class="glass-card p-6 md:p-8 rounded-3xl">
                    <label class="block font-bold text-slate-800 mb-3">âœ¨ è¶…è¶Šåˆ†æ•¸çš„è‚¯å®š (å¿…å¡«)</label>
                    <textarea id="potential-text" class="input-field h-32" placeholder="ä½ åœ¨å“ªç§‘ç™¼ç¾äº†è‡ªå·±è§£æ±ºè¤‡é›œå•é¡Œçš„èƒ½åŠ›ï¼Ÿ"></textarea>
                </div>
                <div class="glass-card p-6 md:p-8 rounded-3xl flex flex-col items-center text-center">
                    <label class="block font-bold text-slate-800 mb-4">ğŸ“Š é‡åŒ–è©•åƒ¹ï¼šåŠªåŠ›ç¨‹åº¦</label>
                    <div class="quadrant-container" onclick="setQuadrantPos(event)">
                        <div class="axis-h"></div><div class="axis-v"></div>
                        <div class="quad-label top-2 right-2">é«˜æ•ˆé€²åŒ–</div><div class="quad-label top-2 left-2">å¤©è³¦é€æ”¯</div>
                        <div class="quad-label bottom-2 right-2">æ–¹æ³•åèª¤</div><div class="quad-label bottom-2 left-2">å‹•åŠ›ç¼ºå¤±</div>
                        <div id="target-dot"></div>
                    </div>
                    <div class="mt-6 flex items-center gap-4 w-full px-4">
                        <input type="range" min="1" max="10" step="1" value="7" id="effort-range" class="flex-1 accent-blue-600" oninput="document.getElementById('effort-display').innerText = this.value">
                        <span class="text-blue-600 font-bold min-w-[3rem]"><span id="effort-display">7</span> åˆ†</span>
                    </div>
                    <input type="hidden" id="quadrant-value" value="æœªæ¨™è¨˜">
                </div>
            </div>
        </section>

        <!-- ç¬¬äºŒéƒ¨åˆ† -->
        <section class="mb-16 bg-white/40 p-6 md:p-10 rounded-[2.5rem] border border-white">
            <h2 class="section-title text-2xl font-bold">ç¬¬äºŒéƒ¨åˆ†ï¼šå¤šå…ƒè¿½æ±‚èˆ‡åƒ¹å€¼ç™¼ç¾</h2>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                <div class="glass-card p-6 md:p-8 rounded-3xl">
                    <label class="block font-bold text-slate-800 mb-3">ğŸ­ è§’è‰²æ“”ç•¶èˆ‡æˆé•· (å¿…å¡«)</label>
                    <textarea id="role-text" class="input-field h-40" placeholder="ä½ çš„æ ¡å…§å¤–è²¬ä»»ç¶“æ­·è®“ä½ å­¸åˆ°äº†ä»€éº¼å­¸æ ¡æ²’æ•™çš„äº‹ï¼Ÿ"></textarea>
                </div>
                <div class="space-y-6">
                    <div class="glass-card p-6 md:p-8 rounded-3xl">
                        <label class="block font-bold text-slate-800 mb-4">ğŸ’ å…§åœ¨æ€§æ ¼å¼·é … (é¸ä¸‰é …)</label>
                        <div class="flex flex-wrap gap-2">
                            <button class="tag-btn" onclick="toggleTrait(this)">ğŸ§  åˆ¤æ–·åŠ›</button>
                            <button class="tag-btn" onclick="toggleTrait(this)">ğŸ¦¾ æ¯…åŠ›</button>
                            <button class="tag-btn" onclick="toggleTrait(this)">ğŸ¤ åœ˜éšŠå”ä½œ</button>
                            <button class="tag-btn" onclick="toggleTrait(this)">ğŸŒ å…¬æ°‘è²¬ä»»</button>
                            <button class="tag-btn" onclick="toggleTrait(this)">ğŸ”­ é è¦‹</button>
                            <button class="tag-btn" onclick="toggleTrait(this)">â¤ï¸ å…±æƒ…èƒ½åŠ›</button>
                        </div>
                    </div>
                    <div class="glass-card p-6 md:p-8 rounded-3xl">
                        <label class="block font-bold text-slate-800 mb-3">ğŸš© è‡ªæˆ‘å°èˆª (å¿…å¡«)</label>
                        <textarea id="path-text" class="input-field h-28" placeholder="ä¹‹å‰çš„å˜—è©¦å¦‚ä½•å½±éŸ¿ä½ çš„æœªä¾†å°ˆæ¥­é¸æ“‡ï¼Ÿ"></textarea>
                    </div>
                </div>
            </div>
        </section>

        <!-- ç¬¬ä¸‰éƒ¨åˆ†ï¼šæ–°å¢ã€Œå£“åŠ›çš„ä¸»è¦æ€§è³ªã€æç¤ºæ–‡å­— -->
        <section class="mb-16">
            <h2 class="section-title text-2xl font-bold">ç¬¬ä¸‰éƒ¨åˆ†ï¼šå¿ƒç†ç´ è³ªèˆ‡å£“åŠ›èª¿ç¯€</h2>
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                <div class="glass-card p-6 md:p-8 rounded-3xl text-center flex flex-col items-center">
                    <label class="block font-bold text-slate-800 mb-4">ğŸ“ˆ å£“åŠ›è¨ºæ–· (1-10)</label>
                    <input id="stress-index" type="number" min="1" max="10" class="w-20 h-20 text-3xl font-bold text-center border-4 border-blue-50 rounded-full mb-6 focus:border-blue-200 outline-none" value="5">
                    
                    <div class="w-full text-left">
                        <p class="text-sm font-bold text-slate-500 mb-3 border-t pt-4">å£“åŠ›çš„ä¸»è¦æ€§è³ªï¼š</p>
                        <div class="space-y-2">
                            <label class="flex items-center gap-2 p-2 hover:bg-blue-50 rounded-xl cursor-pointer transition"><input type="radio" name="stress-type" value="æˆé•·çš„å‹•åŠ›" checked class="w-4 h-4"> ğŸŒ± æˆé•·çš„å‹•åŠ›</label>
                            <label class="flex items-center gap-2 p-2 hover:bg-blue-50 rounded-xl cursor-pointer transition"><input type="radio" name="stress-type" value="æ²‰é‡çš„è² æ“”" class="w-4 h-4"> â˜ï¸ æ²‰é‡çš„è² æ“”</label>
                            <label class="flex items-center gap-2 p-2 hover:bg-blue-50 rounded-xl cursor-pointer transition"><input type="radio" name="stress-type" value="è®“æˆ‘æ„Ÿåˆ°éº»æœ¨" class="w-4 h-4"> ğŸ˜¶ è®“æˆ‘æ„Ÿåˆ°éº»æœ¨</label>
                        </div>
                    </div>
                </div>
                <div class="md:col-span-2 glass-card p-6 md:p-8 rounded-3xl">
                    <label class="block font-bold text-slate-800 mb-3">ğŸ’­ ç„¦æ…®å°è©±</label>
                    <textarea id="anxiety-text" class="input-field h-24" placeholder="å…·é«”ç„¦æ…®çš„åŸå› æ˜¯ä»€éº¼ï¼Ÿ"></textarea>
                    <label class="block font-bold text-slate-800 mt-6 mb-3">ğŸ æƒ…ç·’æ€¥æ•‘ç®±</label>
                    <input id="relax-methods" type="text" class="input-field" placeholder="åˆ—å‡ºä¸‰ä»¶è®“ä½ æ”¾é¬†çš„äº‹...">
                </div>
            </div>
        </section>

        <!-- ç¬¬å››éƒ¨åˆ† -->
        <section id="part4" class="relative">
            <div class="absolute inset-0 bg-slate-900 rounded-[3rem] shadow-2xl -rotate-1 scale-[1.01]"></div>
            <div class="relative bg-slate-800 text-white p-8 md:p-12 rounded-[3rem]">
                <h2 class="text-2xl font-bold mb-8 flex items-center gap-3">ğŸ¯ ç¬¬å››éƒ¨åˆ†ï¼šç²¾æº–å„ªåŒ–èˆ‡æˆ°ç•¥è¡Œå‹•</h2>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-8 mb-8">
                    <div class="space-y-4">
                        <label class="block font-bold text-blue-300">ğŸ“ ç²¾æº–èª¿æ•´</label>
                        <textarea id="adjustment-text" class="w-full bg-slate-700/50 border border-slate-600 rounded-xl p-4 h-32 outline-none focus:ring-2 focus:ring-blue-400" placeholder="ä¸‹å­¸æœŸæˆ‘æœƒåœæ­¢åšä»€éº¼ï¼Ÿé–‹å§‹åšä»€éº¼ï¼Ÿ"></textarea>
                    </div>
                    <div class="space-y-4">
                        <label class="block font-bold text-green-300">ğŸ”‘ è³‡æºç²å–</label>
                        <textarea id="resource-text" class="w-full bg-slate-700/50 border border-slate-600 rounded-xl p-4 h-32 outline-none focus:ring-2 focus:ring-green-400" placeholder="æˆ‘éœ€è¦å“ªæ–¹é¢çš„æ”¯æŒï¼Ÿï¼ˆå¦‚è€å¸«æŒ‡å°ã€åŒå­¸è¨è«–ã€å®‰éœç’°å¢ƒï¼‰"></textarea>
                    </div>
                </div>

                <div class="bg-white p-6 md:p-10 rounded-3xl text-slate-900">
                    <label class="block font-bold mb-4 text-center italic text-slate-500">âœ‰ï¸ çµ¦åŠå¹´å¾Œè‡ªå·±çš„ç•™è¨€</label>
                    <textarea id="self-message" class="w-full border-b-2 border-slate-100 p-4 h-24 text-center text-lg italic outline-none resize-none bg-transparent" placeholder="å¯«ä¸‹ä¸€æ®µè©±çµ¦æœªä¾†çš„è‡ªå·±..."></textarea>
                </div>

                <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mt-10">
                    <button onclick="validateAndSubmit()" class="w-full bg-blue-600 hover:bg-blue-500 py-4 rounded-2xl font-bold text-lg shadow-lg transition active:scale-95">
                        ğŸš€ åŒæ­¥æ•¸æ“šåˆ°é›²ç«¯
                    </button>
                    <button onclick="downloadReport()" class="w-full bg-emerald-600 hover:bg-emerald-500 py-4 rounded-2xl font-bold text-lg shadow-lg transition flex items-center justify-center gap-2 active:scale-95">
                        ğŸ“¥ ä¸‹è¼‰æˆ‘çš„å ±å‘Š (TXT)
                    </button>
                </div>
                <p class="text-center text-slate-400 text-xs mt-6">å»ºè­°åŒå­¸åœ¨åŒæ­¥å¾Œä¸‹è¼‰ä¸€ä»½å‰¯æœ¬å‚™ä»½ï¼Œä»¥ä¾¿å®¶é•·æ—¥èˆ‡çˆ¶æ¯æºé€šã€‚</p>
            </div>
        </section>
    </main>

    <script>
        // è«‹ç¢ºä¿æ­¤é€£çµå·²æ›´æ–°ç‚ºä½ çš„ Google Apps Script ä½ˆç½²é€£çµ
        const googleSheetAppUrl = "https://script.google.com/macros/s/AKfycbwxF0qtMmw3iAxo3KhVGr5UBKkqq5HbUdwc5UTU1U2Mmpzaf-NgLhn8hK7d26QKnkrHQw/exec"; 

        function setQuadrantPos(e) {
            const rect = e.currentTarget.getBoundingClientRect();
            const x = e.clientX - rect.left;
            const y = e.clientY - rect.top;
            const dot = document.getElementById('target-dot');
            dot.style.display = 'block';
            dot.style.left = x + 'px';
            dot.style.top = y + 'px';
            const midX = rect.width / 2;
            const midY = rect.height / 2;
            let result = (x >= midX && y < midY) ? "é«˜æ•ˆé€²åŒ– (å³ä¸Š)" : (x < midX && y < midY) ? "å¤©è³¦é€æ”¯ (å·¦ä¸Š)" : (x >= midX && y >= midY) ? "æ–¹æ³•åèª¤ (å³ä¸‹)" : "å‹•åŠ›ç¼ºå¤± (å·¦ä¸‹)";
            document.getElementById('quadrant-value').value = result;
        }

        function unlockContent() {
            const select = document.getElementById('student-selector');
            const main = document.getElementById('main-content');
            const display = document.getElementById('user-display');
            if(select.value) {
                main.style.display = 'block';
                display.innerText = `ğŸ‘¤ ${select.value}`;
                display.classList.remove('hidden');
                // è‡ªå‹•æ»¾å‹•åˆ°å…§å®¹å€
                setTimeout(() => main.scrollIntoView({ behavior: 'smooth', block: 'start' }), 300);
            }
        }

        function toggleTrait(btn) { btn.classList.toggle('active'); }

        function getFormData() {
            const nameSelect = document.getElementById('student-selector');
            return {
                studentName: nameSelect.value,
                resilience: document.getElementById('resilience-text').value,
                strategy: document.getElementById('strategy-text').value,
                potential: document.getElementById('potential-text').value,
                quadrant: document.getElementById('quadrant-value').value,
                effort: document.getElementById('effort-display').innerText,
                role: document.getElementById('role-text').value,
                traits: Array.from(document.querySelectorAll('.tag-btn.active')).map(b => b.innerText).join(', '),
                path: document.getElementById('path-text').value,
                stressIndex: document.getElementById('stress-index').value,
                stressType: document.querySelector('input[name="stress-type"]:checked')?.value || "æœªé¸",
                anxiety: document.getElementById('anxiety-text').value,
                relaxMethods: document.getElementById('relax-methods').value,
                adjustment: document.getElementById('adjustment-text').value,
                resource: document.getElementById('resource-text').value,
                message: document.getElementById('self-message').value
            };
        }

        async function validateAndSubmit() {
            const form = getFormData();
            if(!form.studentName || !form.resilience || !form.message) {
                alert("âš ï¸ è«‹ç¢ºä¿å§“ååŠæ ¸å¿ƒå…§å®¹ï¼ˆå¦‚éŸŒæ€§ã€ç•™è¨€ï¼‰å·²å¡«å¯«ã€‚");
                return;
            }
            document.getElementById('loading-overlay').style.display = 'flex';
            try {
                // ç™¼é€æ•¸æ“šåˆ° Google Sheets
                await fetch(googleSheetAppUrl, { method: 'POST', mode: 'no-cors', body: JSON.stringify(form) });
            } catch(e) {
                console.error("æäº¤å¤±æ•—:", e);
            }
            setTimeout(() => {
                document.getElementById('loading-overlay').style.display = 'none';
                alert("âœ¨ åŒæ­¥æˆåŠŸï¼è€å¸«å·²æ”¶åˆ°ä½ çš„å°èˆªæ•¸æ“šã€‚");
            }, 1000);
        }

        function downloadReport() {
            const data = getFormData();
            if(!data.studentName) { alert("è«‹å…ˆé¸æ“‡ä½ çš„å§“åã€‚"); return; }
            
            const content = `
========================================
    25-28 é«˜ä¸­Bçµ„ï¼æœªä¾†å°èˆªè‡ªè©•å ±å‘Š
========================================
å­¸ç”Ÿå§“åï¼š${data.studentName}
ç”Ÿæˆæ™‚é–“ï¼š${new Date().toLocaleString()}

ã€ç¬¬ä¸€éƒ¨åˆ†ï¼šå­¸æ¥­ç­–ç•¥èˆ‡èªçŸ¥éŸŒæ€§ã€‘
â— éŸŒæ€§æ™‚åˆ»ï¼š
  ${data.resilience || 'æœªå¡«å¯«'}
â— ç­–ç•¥é€²åŒ–ï¼š
  ${data.strategy || 'æœªå¡«å¯«'}
â— è¶…è¶Šåˆ†æ•¸çš„è‚¯å®šï¼š
  ${data.potential || 'æœªå¡«å¯«'}
â— åŠªåŠ›ç¨‹åº¦è‡ªè©•ï¼š${data.effort} åˆ† / 10 åˆ†
â— åŠªåŠ›å®šä½ï¼š${data.quadrant}

ã€ç¬¬äºŒéƒ¨åˆ†ï¼šå¤šå…ƒè¿½æ±‚èˆ‡åƒ¹å€¼ç™¼ç¾ã€‘
â— è§’è‰²æ“”ç•¶èˆ‡æˆé•·ï¼š
  ${data.role || 'æœªå¡«å¯«'}
â— æ€§æ ¼å¼·é …ï¼š${data.traits || 'æœªé¸æ“‡'}
â— è‡ªæˆ‘å°èˆªï¼ˆæœªä¾†è·¯å¾‘ï¼‰ï¼š
  ${data.path || 'æœªå¡«å¯«'}

ã€ç¬¬ä¸‰éƒ¨åˆ†ï¼šå¿ƒç†ç´ è³ªèˆ‡å£“åŠ›èª¿ç¯€ã€‘
â— å£“åŠ›æŒ‡æ•¸ï¼š${data.stressIndex} åˆ† / 10 åˆ†
â— å£“åŠ›çš„ä¸»è¦æ€§è³ªï¼š${data.stressType}
â— ç„¦æ…®ä¾†æºï¼š
  ${data.anxiety || 'æœªå¡«å¯«'}
â— æƒ…ç·’æ€¥æ•‘ç®±ï¼š${data.relaxMethods || 'æœªå¡«å¯«'}

ã€ç¬¬å››éƒ¨åˆ†ï¼šç²¾æº–å„ªåŒ–èˆ‡æˆ°ç•¥è¡Œå‹•ã€‘
â— ç²¾æº–èª¿æ•´ï¼ˆåœæ­¢/é–‹å§‹ï¼‰ï¼š
  ${data.adjustment || 'æœªå¡«å¯«'}
â— è³‡æºç²å–ï¼š
  ${data.resource || 'æœªå¡«å¯«'}

ã€è‡ªæˆ‘å®£è¨€ï¼šçµ¦åŠå¹´å¾Œçš„è‡ªå·±ã€‘
ã€Œ ${data.message || 'ä¿æŒåˆå¿ƒï¼Œç¹¼çºŒå‰è¡Œã€‚'} ã€

========================================
æ­å–œä½ å®Œæˆå›é¡§ï¼Œç¥ä½ åœ¨ä¸‹å­¸æœŸç²¾æº–å°èˆªï¼Œçœ‹è¦‹æ›´å¥½çš„è‡ªå·±ï¼
========================================
`;
            const blob = new Blob([content], { type: 'text/plain;charset=utf-8' });
            const link = document.createElement('a');
            link.href = URL.createObjectURL(blob);
            link.download = `æœªä¾†å°èˆªå ±å‘Š_${data.studentName}.txt`;
            link.click();
        }
    </script>
</body>
</html>
